<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Monte Carlo Simulation | Raphaël GUITTON </title> <meta name="author" content="Raphaël GUITTON"> <meta name="description" content="An introduction to the Monte Carlo method"> <meta name="keywords" content="raphael-guitton, guitton, raphael-guitton-profile"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="/assets/img/higgs_field_icon.png?6e60d949b57046f29340858ef5cf0a3e"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://roronoarapha.github.io/monte-carlo/"> <script src="/assets/js/theme.js?a5ca4084d3b81624bcfa01156dae2b8e"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>initTheme();</script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Raphaël</span> GUITTON </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications </a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">Projects </a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">repositories </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">CV </a> </li> <li class="nav-item "> <a class="nav-link" href="/solution/">Solutions </a> </li> <li class="nav-item "> <a class="nav-link" href="/higgs/">Higgs Physics </a> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">submenus </a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item " href="/publications/">publications</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/projects/">projects</a> </div> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Monte Carlo Simulation</h1> <p class="post-description">An introduction to the Monte Carlo method</p> </header> <article> <h2 id="numerical-integration">Numerical Integration</h2> <p>In physics and many applied sciences, computing integrals is essential for modeling real-world phenomena. Whether it is to evaluate physical quantities such as energy, probability distributions, or statistical expectations, integration appears in many contexts. However many integrals cannot be solved analytically, requiring <strong>numerical methods</strong> for their evaluation.</p> <p>For example, we often need to compute the integral of a function \(f(x)\) over an interval \([a,b]\):</p> \[I=\int_a^b f(x)\,dx.\] <hr> <h3 id="from-continuous-to-discrete">From Continuous to Discrete</h3> <p>By definition, the <strong>definite integral</strong> of a continuous function \(f\) over the interval \([a, b]\), denoted as:</p> \[I = \int_a^b f(x)\,dx,\] <p>is the <strong>limit of a Riemann sum</strong> as the number of subdivisions \(n\) approaches infinity:</p> \[\int_{a}^{b} f(x)dx = \lim_{n \to \infty} \sum_{i=1}^{n} f(x_i) \Delta x,\] <p>where \(\Delta x = \frac{b-a}{n}\) and \(x_i = a + i \cdot \Delta x\) (left point approximation).</p> <p>As we increase the number of subdivisions \(n\), the Riemann sum becomes a better approximation of the integral. This can be visualized in the following animation:</p> <div align="center"> <img src="../assets/img/statistics/Riemann_sum.gif" alt="Riemann Sum Approximation" width="300"> </div> <p>Each rectangle has an area of \(f(x_i) \Delta x\) and is chosen regularly, meaning that the points \(x_i\) are equally spaced.</p> <h3 id="equivalence-with-uniform-sampling">Equivalence with Uniform Sampling</h3> <p>In the <strong>Riemann sum</strong> integration method, and other classical methods, the entire interval \([a, b]\) is represented equally. Similarly, instead of summing over regularly spaced points, we could choose a <strong>random variable</strong> \(X\) following a <strong>uniform probability density function</strong> over \([a, b]\), given by:</p> \[p(x) = \frac{1}{b-a}, \quad x \in [a, b].\] <p>Rewriting the Riemann sum using this random variable, we obtain the following approximation:</p> \[I \approx (b-a) \cdot \frac{1}{N} \sum_{i=1}^{N} f(X_i),\] <p>where \(X_i \sim \mathcal{U}(a, b)\) are \(N\) independent and identically distributed (i.i.d.) random samples.</p> <blockquote> <p>The key observation here is that the order of summation does not matter, as long as all parts of the interval are represented equally. We expect to obtain the same integral estimation choosing the \(x_i\) from a uniform distribution as the Riemann sum for a sufficiently large number of points.</p> </blockquote> <p>This formulation forms the basis of the <strong>Monte Carlo integration method</strong>, where instead of using a regular grid, we estimate the integral by taking random samples.</p> <blockquote> <p><strong>Monte Carlo methods are techniques that use random sampling and probability statistics to solve problems, particularly those involving integration and optimization.</strong></p> </blockquote> <h3 id="alternative-numerical-methods">Alternative Numerical Methods</h3> <p>Several classical numerical methods exist to approximate the value of an integral.</p> <ul> <li> <p>One such method is the <strong>trapezoidal rule</strong>, which approximates the integral as: \(I \approx \frac{\Delta x}{2} \sum_{i=0}^{N-1} (f(x_i) + f(x_{i+1}))\)</p> </li> <li> <p>Another common approach is <strong>Simpson’s rule</strong>, which provides a higher-order approximation using parabolic interpolation: \(I\approx\frac{\Delta x}{3}\sum_{i=0}^{N/2}f(x_{2i})+4f(x_{2i+1})+f(x_{2i+2})\)</p> </li> </ul> <p>For a one dimension integral, those two methods have convergence rates proportional to \(\propto(1/N^{2})\) for the trapezoidal method and \(\propto(1/N^{4})\) for the Simpson one.</p> <p>However for a <strong>\(d\)-dimensional integral</strong> their convergence rates decrease as \(\propto(1/N^{2/d})\) for the trapezoidal method and \(\propto(1/N^{4/d})\) for the Simpson one.</p> <p>As \(d\) increases, these deterministic methods become inefficient due to the <strong>curse of dimensionality</strong>.</p> <h3 id="monte-carlo-integration">Monte Carlo Integration</h3> <p>An alternative approach is <strong>Monte Carlo integration</strong>, which relies on random sampling rather than a structured grid.</p> <p>The key advantage of Monte Carlo methods is that their convergence rate is <strong>independent of dimension</strong> and proportional to \(\propto(1/\sqrt{N})\)</p> <p>For a <strong>4d integral</strong>, Monte Carlo converges as fast as the trapezoidal rule. For an <strong>8d integral</strong>, it converges as fast as Simpson’s rule. And for higher dimensions, Monte Carlo becomes significantly more efficient.</p> <p>We previously considered Monte Carlo integration using a uniform distribution, but we can generalize this idea by using any probability density function (PDF). Consider then a random variable \(X\) with probability density function \(p(x)\), the transfer theorem gives: \(\mathbb{E}(f(X)) = \int_a^b f(x) p(x) \, \mathrm{d}x.\)</p> <div id="transfert-theorem"> <details> <summary>About Transfer Theorem</summary> &gt; The transfer theorem is a fundamental theorem in probability theory that allows us to express the expectation of a function of a random variable $$X$$ as an integral against the law of $$X$$. Its general form is as follows: &gt; **Theorem:** Let $$(\Omega, \mathcal{B}, \mathbb{P})$$ be a probability space and let $$X: (\Omega, \mathcal{A}, \mathbb{P}) \to \mathbb{R}$$ be a random variable whose law is denoted by $$\mathbb{P}_X$$. Then: &gt; 1. For any measurable function $$\varphi: \mathbb{R} \to \mathbb{R}_+$$, we have: $$\int_{\Omega} \varphi(X(\omega)) \, \mathrm{d}\mathbb{P}(\omega) = \int_{\mathbb{R}} \varphi(x) \, \mathrm{d}\mathbb{P}_X(x)$$ </details> </div> <p>If our goal is to compute the integral of \(f(x)\), we can rewrite it as</p> \[I = \int_a^b f(x) \, dx = \int_a^b \frac{f(x)}{p(x)} \, p(x) \, dx = \mathbb{E}\left[\frac{f(X)}{p(X)}\right]\] <p>From the Law of large number we get that \(\mathbb{E} \left( \frac{f(X)}{p(X)} \right) =\int_a^b \frac{f(x)}{p(x)} p(x) dx \approx \frac{1}{N} \sum_{i=1}^{N} \frac{f(x_i)}{p(x_i)} = I_N\)</p> <div id="law-of-large-number"> <details> <summary>About Law of Large Number</summary> &gt; The law of Large number tells us that if we take a sequence of independent and identically distributed (i.i.d) random variables $$X_i$$ with an expectation $$\mathbb{E}[X]$$, then the empirical mean converges almost surely to the expectation: &gt; $$\frac{1}{N} \sum_{i=1}^{N} X_i \quad \xrightarrow{N \to \infty} \quad \mathbb{E}[X]$$ </details> </div> <p>Ok but now, how do you choose your pdf? Well, we will see that the choice of the pdf is really important in regards to the uncertainties for the estimated integral value.</p> <h3 id="choice-of-pdf-and-uncertainties">Choice of pdf and Uncertainties</h3> <p>The Central Limit Theorem (CLT) tells us that for sufficiently large \(N\), the distribution of \(I_N\) is approximately normal:</p> <p>\(I_N \approx \mathcal{N} \left( I, \frac{\sigma^2}{N} \right)\) with \(\sigma^2 = \mathbb{V} \left[ \frac{f(X)}{p(X)} \right]\)</p> <div id="central-limit"> <details> <summary>About central limit</summary> &gt; The Central Limit Theorem states that, given a sufficiently large sample size, the distribution of the sample mean of i.i.d. random variables approaches a normal distribution, regardless of the original distribution of the variables. </details> </div> <p><strong>The choice of the pdf \(p(x)\) directly influences \(\sigma^2\) and, consequently, the uncertainty in the estimated integral.</strong> By selecting an appropriate PDF, we can significantly improve the accuracy and efficiency of Monte Carlo integration.</p> <p>Rest on another page</p> </article> </div> <div class="navigation"> <a href="/Documentation/" class="prev-page">Previous: Documentation</a> <a href="/inverse-transform-sampling/" class="next-page">Next: Inverse Transform Sampling</a> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2025 Raphaël GUITTON. Last updated: February 19, 2025. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?5d75c11f89cd96294bf5e6dd1ee1bb30"></script> <script defer src="/assets/js/common.js?fcfacfb8c6281f5e68d5a7d348186eb1"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>